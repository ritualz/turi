<% content_for :page_title do %>
    equipment | <%= @equipment_list.name %> | <%= @equipment_item.name %>
<% end %>

<% content_for :page_class do %>
    background_image 
<% end %>

<%= render 'equipment_lists/sidebar' %>
<div class="col-md-offset-3 col-md-6 text-center">

    <!-- begin block -->
    <div class='block'>
        <!-- begin block title -->
        <div class='block-title'>
            <!-- begin drop down menu -->
            <div class='block-options pull-right'>
                <div class='btn-group'>
                    <% if policy(@trip).update? %>
                        <a aria-expanded="false" data-original-title="options" style="overflow: hidden; position: relative;" class="btn btn-effect-ripple btn-default dropdown-toggle enable-tooltip" data-toggle="dropdown" title="">
                            <span style="height: 34px; width: 34px; top: 10px; left: -7.66669px;" class="btn-ripple animate"></span>
                            <i class="fa fa-chevron-down"></i></a>
                            
                            <ul class="dropdown-menu dropdown-menu-right">
                                <li>
                                    <a href="<%= edit_trip_equipment_list_equipment_item_path(@trip, @equipment_list, @equipment_item) %>", id='edit_equipment_item'>
                                        <i class="fa fa-pencil pull-right"></i>
                                        edit
                                    </a>
                                </li>
                                <% if current_user.id == @equipment_item.user_id or policy(@trip).destroy? %>
                                    <li class="divider"></li>
                                    <li>
                                        <%= link_to raw('<i class="fa fa-trash-o fa-fw pull-right"></i> delete'),
                                            trip_equipment_list_equipment_item_path(@trip, @equipment_list, @equipment_item),
                                            :method => :delete,
                                            :data => {
                                                :confirm    => 'are you sure you want to delete this equipment item?',
                                                :toogle     => 'tooltip'
                                            },
                                            :class => 'text-danger',
                                            :title => '',
                                            :id    => 'delete_equipment_item'
                                        %>
                                    </li>
                                <% end %>
                            </ul>
                        <% end %>
                </div>
                <!-- end drop down menu -->
            </div>
            <h2><%= @equipment_item.name %></h2>
        <!-- end block title -->        
        </div>
        <!-- begin body -->

        <p> </h2> Created by </h2> <%= User.find(@equipment_item.user_id).name %> </p>
        <p> <h3> Number of items </h3> <%= @equipment_item.number %> </p>
        <p> <h3> Price </h3> <%= @equipment_item.price %> </p>

        <!-- list all assignments for item -->
        <% @equipment_item.equipment_assignments.each do |assignment| %>
            <li>
                Assigned to/by <%= User.find(assignment.user_id).name %>
                Number of items: <%= assignment.number %>
                <% if current_user.id == @equipment_item.user_id || policy(@trip).update? %>
                    <%= link_to raw('<i class="fa fa-trash-o fa-fw pull-right"></i>'),
                        trip_equipment_list_equipment_item_equipment_assignment_path(@trip, @equipment_list, @equipment_item, assignment),
                        :method => :delete,
                        :data => {
                            :confirm => 'are you sure you want to delete this equipment assignment?',
                            :toggle => 'tooltip'
                        },
                        :class => 'text-danger',
                        :title => '',
                        :id => 'delete_equipment_assignment'
                    %>
                    <a href="<%= edit_trip_equipment_list_equipment_item_equipment_assignment_path(@trip, @equipment_list, @equipment_item, assignment) %>" id="edit_equipment_assignment" class='fa fa-pencil pull-right'></a>
                <% end %>
            </li>
        <% end %>

        <!-- render form unless all the items assigned -->
        <% unless @equipment_item.equipment_assignments.sum(:number) == @equipment_item.number %>
            <%= render :partial => 'equipment_assignments/form' %>
        <% end %>

    <!-- end render form  -->
    </div>
    <!-- end block -->        
</div>



